<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>C·∫Øm C√¢u C√° L√≥c - Cloud Edition</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Arial', sans-serif;
        }
        
        :root {
            --primary-color: #ffc800;
            --secondary-color: #0046a0;
            --danger-color: #c80000;
            --success-color: #0a640a;
            --warning-color: #b4b400;
            --christmas-color: #ff0000;
        }
        
        body {
            background: linear-gradient(135deg, #0a640a, #1e7c1e, #2a8a2a);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 10px;
        }
        
        #game-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            min-height: 90vh;
            position: relative;
            overflow: hidden;
        }
        
        #game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--success-color));
            z-index: 10;
        }
        
        .screen {
            display: none;
            width: 100%;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .active {
            display: block !important;
        }
        
        h1, h2, h3 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 24px;
            background: linear-gradient(45deg, var(--primary-color), #ffeb3b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(50, 50, 50, 0.9);
            padding: 15px;
            border-radius: 15px;
            font-size: 14px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
            position: relative;
        }
        
        .stat-item::after {
            content: '';
            position: absolute;
            right: 0;
            top: 10%;
            height: 80%;
            width: 1px;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .stat-item:last-child::after {
            display: none;
        }
        
        .button {
            display: block;
            width: 100%;
            padding: 18px;
            margin: 12px 0;
            background: var(--primary-color);
            color: black;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .button:hover::before {
            left: 100%;
        }
        
        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }
        
        .button:active {
            transform: translateY(0);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .button.red {
            background: linear-gradient(45deg, var(--danger-color), #ff4444);
            color: white;
        }
        
        .button.blue {
            background: linear-gradient(45deg, var(--secondary-color), #0066cc);
            color: white;
        }
        
        .button.green {
            background: linear-gradient(45deg, var(--success-color), #2a8a2a);
            color: white;
        }
        
        .button.market {
            background: linear-gradient(45deg, var(--warning-color), #d4d400);
            color: white;
        }
        
        .button.christmas {
            background: linear-gradient(45deg, var(--christmas-color), #ff4444);
            color: white;
            animation: glow 2s infinite;
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px var(--christmas-color); }
            50% { box-shadow: 0 0 20px var(--christmas-color); }
        }
        
        .button.premium {
            background: linear-gradient(45deg, #ffd700, #ff6b00);
            color: black;
            border: 2px solid #ffd700;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(100, 100, 100, 0.5);
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .hp-bar .progress-fill {
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
        }
        
        .exp-bar .progress-fill {
            background: linear-gradient(90deg, #00ffff, #00b3b3);
        }
        
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            z-index: 1000;
            display: none;
            width: 85%;
            max-width: 350px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.8);
            border: 2px solid var(--primary-color);
            animation: popIn 0.3s ease;
        }
        
        @keyframes popIn {
            from { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .message.active {
            display: block;
        }
        
        .back-button {
            margin-top: 25px;
            background: rgba(100, 100, 100, 0.7) !important;
        }
        
        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 8px 0;
            background: rgba(50, 50, 50, 0.6);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .inventory-item:hover {
            background: rgba(70, 70, 70, 0.8);
            transform: translateX(5px);
        }
        
        .rod-item {
            background: rgba(0, 70, 160, 0.3);
            border-left: 4px solid var(--secondary-color);
        }
        
        .fish-item {
            background: rgba(10, 100, 10, 0.3);
            border-left: 4px solid var(--success-color);
        }
        
        .premium-item {
            background: rgba(255, 215, 0, 0.2);
            border-left: 4px solid #ffd700;
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            background: var(--primary-color);
            color: black;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .badge.premium {
            background: #ffd700;
        }
        
        .badge.new {
            background: var(--danger-color);
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .event-banner {
            background: linear-gradient(45deg, var(--christmas-color), #ff6b6b);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(255, 0, 0, 0.3);
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .event-banner.double-exp {
            background: linear-gradient(45deg, #00ff00, #00b300);
        }
        
        .event-banner.lucky-day {
            background: linear-gradient(45deg, #ffd700, #ff6b00);
        }
        
        .event-banner.golden-fish {
            background: linear-gradient(45deg, #ffd700, #ffaa00);
        }
        
        .achievement {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid #ffd700;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
        }
        
        .fishing-slot {
            background: rgba(0, 70, 160, 0.4);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .fishing-slot:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        
        .location-slot {
            background: rgba(0, 70, 160, 0.5);
            padding: 20px;
            border-radius: 15px;
            margin: 10px 0;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .location-slot:hover {
            background: rgba(0, 70, 160, 0.7);
            transform: scale(1.02);
        }
        
        .upgrade-option {
            background: rgba(50, 50, 50, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .timer {
            font-size: 12px;
            color: #ffeb3b;
            font-weight: bold;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
            animation: slideIn 0.5s ease;
            max-width: 300px;
            word-wrap: break-word;
        }
        
        .notification.queue {
            animation: slideInQueue 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInQueue {
            from { transform: translateX(100%) translateY(20px); opacity: 0; }
            to { transform: translateX(0) translateY(0); opacity: 1; }
        }
        
        .floating-coin {
            position: absolute;
            animation: float 1s ease-out;
            font-size: 20px;
            color: #ffd700;
            font-weight: bold;
            pointer-events: none;
        }
        
        @keyframes float {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        
        .shop-item {
            background: rgba(50, 50, 50, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .skill-item {
            background: rgba(0, 70, 160, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--secondary-color);
        }
        
        .event-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .event-effect.active {
            opacity: 1;
            animation: sparkle 2s infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        .login-form {
            background: rgba(50, 50, 50, 0.7);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
        }
        
        .login-form input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        
        .login-form input::placeholder {
            color: #ccc;
        }
        
        .user-info {
            background: rgba(0, 70, 160, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }
        
        .github-status {
            font-size: 12px;
            color: #ccc;
            margin-top: 5px;
        }
        
        .github-status.connected {
            color: #00ff00;
        }
        
        .github-status.error {
            color: #ff4444;
        }
        
        .auto-login-info {
            background: rgba(0, 100, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
            font-size: 14px;
        }
        
        .location-slot.inactive {
            opacity: 0.6;
            background: rgba(100, 100, 100, 0.5);
        }
        
        .location-slot.inactive:hover {
            background: rgba(100, 100, 100, 0.5);
            transform: none;
            cursor: not-allowed;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            flex-direction: column;
            color: white;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .account-list {
            background: rgba(50, 50, 50, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .account-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .account-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .cloud-badge {
            background: #00aaff;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            margin-left: 5px;
        }
        
        .fish-caught-indicator {
            background: linear-gradient(45deg, #ffd700, #ffaa00);
            color: black;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay" style="display: none;">
            <div class="loading-spinner"></div>
            <div id="loading-text">ƒêang k·∫øt n·ªëi Cloud...</div>
        </div>

        <!-- Hi·ªáu ·ª©ng s·ª± ki·ªán -->
        <div id="event-effect" class="event-effect"></div>
        
        <!-- Th√¥ng b√°o n·ªïi -->
        <div id="notification" class="notification"></div>
        
        <!-- M√†n h√¨nh ƒëƒÉng nh·∫≠p -->
        <div id="login-screen" class="screen active">
            <h1>üé£ C·∫ÆM C√ÇU C√Å L√ìC ‚òÅÔ∏è</h1>
            
            <div class="auto-login-info">
                <h3>‚úÖ H·ªÜ TH·ªêNG L∆ØU ƒê√ÅM M√ÇY</h3>
                <div>D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u ho√†n to√†n tr√™n GitHub Cloud</div>
                <div>Kh√¥ng l∆∞u c·ª•c b·ªô - ƒêa t√†i kho·∫£n</div>
            </div>
            
            <div class="login-form">
                <h3>T·∫°o t√†i kho·∫£n m·ªõi ho·∫∑c ƒëƒÉng nh·∫≠p</h3>
                <input type="text" id="username" placeholder="T√™n ng∆∞·ªùi ch∆°i (kh√¥ng d·∫•u)">
                <input type="password" id="password" placeholder="M·∫≠t kh·∫©u">
                
                <button class="button green" onclick="register()">üìù ƒêƒÇNG K√ù</button>
                <button class="button blue" onclick="login()">üöÄ ƒêƒÇNG NH·∫¨P</button>

                <div style="margin-top: 15px; display: none;" id="account-list-container">
                    <h4>üìÇ T√†i kho·∫£n c√≥ s·∫µn tr√™n Cloud:</h4>
                    <div class="account-list" id="account-list">
                        <!-- Danh s√°ch t√†i kho·∫£n s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                    </div>
                </div>
            </div>
            
            <div class="user-info" id="user-info" style="display: none;">
                <h3>Th√¥ng tin ng∆∞·ªùi d√πng</h3>
                <div id="current-user">Ch∆∞a ƒëƒÉng nh·∫≠p</div>
                <div class="github-status connected" id="github-status">‚úÖ ƒê√£ k·∫øt n·ªëi</div>
            </div>
            
            <button class="button red" onclick="autoLoginAndPlay()">üéÆ CH∆†I NGAY (T·ª± ƒë·ªông ƒëƒÉng nh·∫≠p)</button>
        </div>
        
        <!-- M√†n h√¨nh ch√≠nh -->
        <div id="main-menu" class="screen">
            <h1>üé£ C·∫ÆM C√ÇU C√Å L√ìC ‚òÅÔ∏è</h1>
            
            <div class="user-info" id="main-user-info">
                <div id="main-user">Ch∆∞a ƒëƒÉng nh·∫≠p</div>
                <div class="github-status connected" id="main-github-status">‚úÖ ƒê√£ k·∫øt n·ªëi</div>
            </div>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>‚≠ê C·∫•p: <span id="player-level">1</span></div>
                </div>
                <div class="stat-item">
                    <div>üí∞ Xu: <span id="player-coins">1500</span></div>
                </div>
                <div class="stat-item">
                    <div>‚ù§Ô∏è HP: <span id="player-hp">100</span>/100</div>
                </div>
            </div>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>üêü C√°: <span id="player-fish">0</span> con</div>
                </div>
                <div class="stat-item">
                    <div>üèÜ ƒêi·ªÉm: <span id="player-points">0</span></div>
                </div>
            </div>
            
            <!-- Banner s·ª± ki·ªán -->
            <div id="event-banner" class="event-banner" style="display: none;">
                üéâ S·ª∞ KI·ªÜN ƒêANG DI·ªÑN RA! üéâ
            </div>
            
            <button class="button blue" onclick="showScreen('character-screen')">
                üë§ TH√îNG TIN NH√ÇN V·∫¨T
            </button>
            <button class="button" onclick="showScreen('inventory-screen')">
                üéí T√öI ƒê·ªí & SHOP
            </button>
            <button class="button green" onclick="showScreen('select-location')">
                üéØ ƒêI C·∫ÆM C√ÇU
            </button>
            <button class="button red" onclick="showScreen('steal-menu')">
                üïµÔ∏è THƒÇM TR·ªòM C·∫¶N <span class="badge">-20 HP</span>
            </button>
            <button class="button market" onclick="showScreen('market-screen')">
                üè™ CH·ª¢ C√Å <span class="badge new">M·ªöI</span>
            </button>
            <button class="button christmas" onclick="showScreen('events-screen')">
                üéÑ S·ª∞ KI·ªÜN <span class="badge">HOT</span>
            </button>
            <button class="button premium" onclick="showScreen('achievements-screen')">
                üèÜ TH√ÄNH T·ª∞U
            </button>
            <button class="button" onclick="showScreen('account-screen')">
                üîê T√ÄI KHO·∫¢N
            </button>
        </div>
        
        <!-- M√†n h√¨nh t√†i kho·∫£n -->
        <div id="account-screen" class="screen">
            <h1>üîê T√ÄI KHO·∫¢N CLOUD</h1>
            
            <div class="user-info">
                <h3>Th√¥ng tin ng∆∞·ªùi d√πng</h3>
                <div id="account-user">Ch∆∞a ƒëƒÉng nh·∫≠p</div>
                <div class="github-status connected" id="account-github-status"> ƒêang online</div>
            </div>
            
            <div class="login-form">
                <h3>ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</h3>
                <input type="text" id="account-username" placeholder="T√™n ng∆∞·ªùi ch∆°i (kh√¥ng d·∫•u)">
                <input type="password" id="account-password" placeholder="M·∫≠t kh·∫©u">
                
                <button class="button green" onclick="register()">üìù ƒêƒÇNG K√ù</button>
                <button class="button blue" onclick="login()">üöÄ ƒêƒÇNG NH·∫¨P</button>
                
                <div style="margin-top: 20px;">
                    <h3>‚òÅÔ∏è H·ªá th·ªëng l∆∞u Cloud</h3>
                    <div class="auto-login-info">
                        <div>‚úÖ D·ªØ li·ªáu l∆∞u ho√†n to√†n tr√™n GitHub</div>
                        <div>‚ùå Kh√¥ng l∆∞u c·ª•c b·ªô</div>
                        <div>üë• H·ªó tr·ª£ ƒëa t√†i kho·∫£n</div>
                    </div>
                </div>

                <div style="margin-top: 15px;">
                    <h4>üìÇ Qu·∫£n l√Ω t√†i kho·∫£n Cloud:</h4>
                    <button class="button" onclick="listAllAccounts()">üîÑ T·∫£i danh s√°ch t√†i kho·∫£n</button>
                    <button class="button red" onclick="deleteCurrentAccount()" style="margin-top: 10px;">üóëÔ∏è X√≥a t√†i kho·∫£n hi·ªán t·∫°i</button>
                </div>
            </div>
            
            <button class="button red" onclick="logout()">üö™ ƒêƒÇNG XU·∫§T</button>
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh th√¥ng tin nh√¢n v·∫≠t -->
        <div id="character-screen" class="screen">
            <h1>üë§ TH√îNG TIN NH√ÇN V·∫¨T</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>T√™n: <span id="char-name">Ng∆∞ Ph·ªß L√†ng Ch√†i</span></div>
                </div>
                <div class="stat-item">
                    <div>C·∫•p: <span id="char-level">1</span></div>
                </div>
                <div class="stat-item">
                    <div>Xu: <span id="char-coins">1500</span></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>HP: <span id="char-hp">100</span>/100</div>
                <div class="progress-bar hp-bar">
                    <div class="progress-fill" id="char-hp-fill" style="width: 100%"></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>EXP: <span id="char-exp">0</span>/<span id="char-exp-needed">100</span></div>
                <div class="progress-bar exp-bar">
                    <div class="progress-fill" id="char-exp-fill" style="width: 0%"></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>C√° ƒë√£ b·∫Øt: <span id="fish-caught">0</span> con (<span id="fish-weight">0.00</span> kg)</div>
                <div>C√° l·ªõn nh·∫•t: <span id="biggest-fish">0.00</span> kg</div>
            </div>
            
            <h3>üéØ K·ª∏ NƒÇNG</h3>
            <div class="skill-item">
                <div>üé£ K·ªπ nƒÉng c√¢u c√°: <span id="skill-fishing">1</span></div>
                <button class="button" onclick="upgradeSkill('fishing')">N√¢ng c·∫•p (100üí∞)</button>
            </div>
            <div class="skill-item">
                <div>üçÄ May m·∫Øn: <span id="skill-luck">1</span></div>
                <button class="button" onclick="upgradeSkill('luck')">N√¢ng c·∫•p (100üí∞)</button>
            </div>
            <div class="skill-item">
                <div>üí™ S·ª©c ch·ªãu ƒë·ª±ng: <span id="skill-endurance">1</span></div>
                <button class="button" onclick="upgradeSkill('endurance')">N√¢ng c·∫•p (100üí∞)</button>
            </div>
            
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh t√∫i ƒë·ªì -->
        <div id="inventory-screen" class="screen">
            <h1>üéí T√öI ƒê·ªí & SHOP</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>C·∫ßn c√¢u: <span id="inventory-rods-count">2</span>/<span id="inventory-max-rods">5</span></div>
                </div>
                <div class="stat-item">
                    <div>Xu: <span id="inventory-coins">1500</span></div>
                </div>
            </div>
            
            <h3>üé£ C·∫¶N C√ÇU C·ª¶A B·∫†N</h3>
            <div id="rods-container">
                <!-- C·∫ßn c√¢u s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
            
            <h3>üêü C√Å TRONG KHO</h3>
            <div id="fish-container">
                <!-- C√° s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
            
            <button class="button green" onclick="showScreen('shop-screen')">üõí C·ª¨A H√ÄNG</button>
            <button class="button red" onclick="showScreen('sell-fish-screen')">üí∞ B√ÅN C√Å</button>
            
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh c·ª≠a h√†ng -->
        <div id="shop-screen" class="screen">
            <h1>üõí C·ª¨A H√ÄNG</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Xu hi·ªán t·∫°i: <span id="shop-coins">1500</span></div>
                </div>
            </div>
            
            <h3>üé£ C·∫¶N C√ÇU</h3>
            <div class="shop-item">
                <div><strong>C·∫ßn S·∫Øt</strong> - Th·ªùi gian c·∫Øm: 15 ph√∫t</div>
                <div>Gi√°: 10,000üí∞</div>
                <button class="button" onclick="buyRod('iron')">MUA NGAY</button>
            </div>
            
            <div class="shop-item">
                <div><strong>C·∫ßn V√†ng</strong> - Th·ªùi gian c·∫Øm: 20 ph√∫t <span class="badge premium">PREMIUM</span></div>
                <div>Gi√°: 50,000üí∞</div>
                <button class="button premium" onclick="buyRod('gold')">MUA NGAY</button>
            </div>
            
            <h3>‚ö° N√ÇNG C·∫§P</h3>
            <div class="shop-item">
                <div><strong>M·ªü r·ªông gi·ªõi h·∫°n c·∫ßn c√¢u</strong></div>
                <div>Hi·ªán t·∫°i: <span id="current-rod-limit">5</span> c·∫ßn</div>
                <div>Gi√°: 50,000üí∞</div>
                <button class="button blue" onclick="upgradeRodLimit()">N√ÇNG C·∫§P</button>
            </div>
            
            <button class="button back-button" onclick="showScreen('inventory-screen')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh b√°n c√° -->
        <div id="sell-fish-screen" class="screen">
            <h1>üí∞ B√ÅN C√Å</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Xu hi·ªán t·∫°i: <span id="sell-coins">1500</span></div>
                </div>
                <div class="stat-item">
                    <div>T·ªïng gi√° tr·ªã: <span id="total-fish-value">0</span>üí∞</div>
                </div>
            </div>
            
            <div style="margin: 15px 0;">
                <div>Gi√° b√°n C√° L√≥c: 100üí∞/kg</div>
            </div>
            
            <div id="sell-fish-container">
                <!-- C√° ƒë·ªÉ b√°n s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
            
            <button class="button red" onclick="sellAllFish()">üí∞ B√ÅN T·∫§T C·∫¢ C√Å</button>
            
            <button class="button back-button" onclick="showScreen('inventory-screen')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh ch·ªçn khu v·ª±c -->
        <div id="select-location" class="screen">
            <h1>üéØ CH·ªåN KHU V·ª∞C C·∫ÆM C√ÇU</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>C·∫•p hi·ªán t·∫°i: <span id="location-level">1</span></div>
                </div>
            </div>
            
            <div class="location-slot active" onclick="selectLocation('Khu ƒê·ªìng L·ªõn')">
                <div><strong>Khu ƒê·ªìng L·ªõn</strong></div>
                <div>T·ª∑ l·ªá b·∫Øt c√°: 15% m·ªói ph√∫t</div>
                <div>C√° th∆∞·ªùng: 0.1-2kg</div>
                <div>Y√™u c·∫ßu: C·∫•p 1</div>
            </div>
            
            <div class="location-slot inactive" onclick="selectLocation('Khu R·ª´ng Tr√†m')">
                <div><strong>Khu R·ª´ng Tr√†m</strong> <span class="badge new">M·ªöI</span></div>
                <div>T·ª∑ l·ªá b·∫Øt c√°: 10% m·ªói ph√∫t</div>
                <div>C√° l·ªõn: 0.5-3kg</div>
                <div>Y√™u c·∫ßu: C·∫•p 7</div>
            </div>
            
            <div class="location-slot inactive" onclick="selectLocation('H·ªì Thi√™ng')">
                <div><strong>H·ªì Thi√™ng</strong> <span class="badge premium">PREMIUM</span></div>
                <div>T·ª∑ l·ªá b·∫Øt c√°: 5% m·ªói ph√∫t</div>
                <div>C√° kh·ªïng l·ªì: 1-5kg</div>
                <div>Y√™u c·∫ßu: C·∫•p 15</div>
            </div>
            
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh ch·ªçn k√™nh -->
        <div id="select-channel" class="screen">
            <h1 id="channel-location">KHU V·ª∞C: Khu ƒê·ªìng L·ªõn</h1>
            <h2>üì° CH·ªåN K√äNH</h2>
            
            <div class="location-slot active" onclick="selectChannel('K√™nh A')">
                <div><strong>K√™nh A</strong></div>
                <div>ƒê√¥ng ng∆∞·ªùi c√¢u</div>
                <div>T·ª∑ l·ªá +5%</div>
            </div>
            
            <div class="location-slot active" onclick="selectChannel('K√™nh B')">
                <div><strong>K√™nh B</strong></div>
                <div>V·∫Øng v·∫ª</div>
                <div>C√° l·ªõn +10%</div>
            </div>
            
            <div class="location-slot active" onclick="selectChannel('K√™nh C')">
                <div><strong>K√™nh C</strong></div>
                <div>K√™nh cao c·∫•p</div>
                <div>EXP +15%</div>
            </div>
            
            <button class="button back-button" onclick="showScreen('select-location')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh c√¢u c√° -->
        <div id="fishing-screen" class="screen">
            <h1 id="fishing-location">Khu ƒê·ªìng L·ªõn - K√™nh A</h1>
            
            <!-- Ch·ªâ b√°o c√° d√≠nh c√¢u -->
            <div id="fish-caught-indicator" class="fish-caught-indicator" style="display: none;">
                üé£ C√Å ƒê√É D√çNH C√ÇU! H√ÉY THU C√ÇU NGAY! üé£
            </div>
            
            <div id="fishing-slots">
                <div class="fishing-slot">
                    <div style="font-weight: bold; margin-bottom: 10px;">üé£ √î C·∫ÆM C√ÇU 1</div>
                    <div id="slot-1-status">Tr·ªëng</div>
                    <div id="slot-1-timer" class="timer"></div>
                    <button class="button" id="slot-1-button" onclick="startFishing(0)">üé£ C·∫ÆM C√ÇU</button>
                </div>
                <div class="fishing-slot">
                    <div style="font-weight: bold; margin-bottom: 10px;">üé£ √î C·∫ÆM C√ÇU 2</div>
                    <div id="slot-2-status">Tr·ªëng</div>
                    <div id="slot-2-timer" class="timer"></div>
                    <button class="button" id="slot-2-button" onclick="startFishing(1)">üé£ C·∫ÆM C√ÇU</button>
                </div>
            </div>
            
            <div class="stats-bar" style="margin-top: 15px;">
                <div class="stat-item">
                    <div>C·∫ßn Tr·ªëng: <span id="free-rods">2</span>/<span id="fishing-max-rods">5</span></div>
                </div>
                <div class="stat-item">
                    <div>C√° ƒë√£ b·∫Øt: <span id="fishing-fish-count">0</span> con</div>
                </div>
            </div>
            
            <button class="button back-button" onclick="showScreen('select-channel')">‚Üê Quay L·∫°i K√™nh</button>
        </div>
        
        <!-- M√†n h√¨nh thƒÉm tr·ªôm -->
        <div id="steal-menu" class="screen">
            <h1>üïµÔ∏è THƒÇM TR·ªòM C·∫¶N</h1>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 18px; margin-bottom: 15px;">H√†nh ƒë·ªông n√†y t·ªën 20 HP. B·∫°n c√≥ ch·∫Øc mu·ªën ƒëi lu√¥n kh√¥ng?</div>
                <div style="font-size: 16px;">HP hi·ªán t·∫°i: <span id="steal-hp">100</span>/100</div>
            </div>
            
            <button class="button red" onclick="startStealing()">üïµÔ∏è ƒêI LU√îN</button>
            <button class="button blue back-button" onclick="showScreen('main-menu')">ü§î SUY NGHƒ® L·∫†I</button>
        </div>
        
        <!-- M√†n h√¨nh ch·ª£ c√° -->
        <div id="market-screen" class="screen">
            <h1>üè™ CH·ª¢ C√Å</h1>
            <div style="text-align: center; margin: 20px 0;">
                <p>T√≠nh nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...</p>
                <p>üë®‚Äçüíª S·∫Øp ra m·∫Øt!</p>
            </div>
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh s·ª± ki·ªán -->
        <div id="events-screen" class="screen">
            <h1>üéÑ S·ª∞ KI·ªÜN</h1>
            <div id="events-container">
                <!-- Danh s√°ch s·ª± ki·ªán s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
        
        <!-- M√†n h√¨nh th√†nh t·ª±u -->
        <div id="achievements-screen" class="screen">
            <h1>üèÜ TH√ÄNH T·ª∞U</h1>
            <div style="text-align: center; margin: 20px 0;">
                <p>T√≠nh nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn...</p>
                <p>üë®‚Äçüíª S·∫Øp ra m·∫Øt!</p>
            </div>
            <button class="button back-button" onclick="showScreen('main-menu')">‚Üê Quay L·∫°i</button>
        </div>
    </div>
    
    <!-- Th√¥ng b√°o -->
    <div id="message" class="message">
        <div id="message-text">Th√¥ng b√°o</div>
    </div>

    <script>
        // ========== C·∫§U H√åNH GITHUB CLOUD ==========
        const GITHUB_CONFIG = {
            token: "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",
            repo: "di143001-gif/fishing-save",
            connected: true
        };

        // ========== H·ªÜ TH·ªêNG TH√îNG B√ÅO ==========
        let notificationQueue = [];
        let isShowingNotification = false;
        const NOTIFICATION_DURATION = 1000;

        function showNotification(message, duration = NOTIFICATION_DURATION) {
            notificationQueue.push({ message, duration });
            if (!isShowingNotification) {
                processNotificationQueue();
            }
        }

        function processNotificationQueue() {
            if (notificationQueue.length === 0) {
                isShowingNotification = false;
                return;
            }

            isShowingNotification = true;
            const { message, duration } = notificationQueue.shift();
            
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            if (notificationQueue.length > 0) {
                notification.classList.add('queue');
            } else {
                notification.classList.remove('queue');
            }
            
            setTimeout(() => {
                notification.style.display = 'none';
                setTimeout(() => {
                    processNotificationQueue();
                }, 100);
            }, duration);
        }

        // ========== H·ªÜ TH·ªêNG LOADING ==========
        function showLoading(text = "ƒêang k·∫øt n·ªëi Cloud...") {
            const loading = document.getElementById('loading-overlay');
            const loadingText = document.getElementById('loading-text');
            loadingText.textContent = text;
            loading.style.display = 'flex';
        }

        function hideLoading() {
            const loading = document.getElementById('loading-overlay');
            loading.style.display = 'none';
        }

        // ========== H·ªÜ TH·ªêNG ƒêƒÇNG NH·∫¨P CLOUD ==========
        let currentUser = null;

        // H√†m l·∫•y danh s√°ch t·∫•t c·∫£ t√†i kho·∫£n t·ª´ GitHub
        async function getAllAccountsFromGitHub() {
            try {
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const files = await response.json();
                    const accountFiles = files.filter(file => 
                        file.name.startsWith('fishing_game_') && file.name.endsWith('.json')
                    );
                    
                    const accounts = accountFiles.map(file => {
                        const username = file.name.replace('fishing_game_', '').replace('.json', '');
                        return {
                            username: username,
                            size: file.size,
                            lastModified: file.name
                        };
                    });
                    
                    return accounts;
                }
                return [];
            } catch (error) {
                console.log('‚ùå L·ªói khi l·∫•y danh s√°ch t√†i kho·∫£n:', error);
                return [];
            }
        }

        // Hi·ªÉn th·ªã danh s√°ch t√†i kho·∫£n
        async function listAllAccounts() {
            showLoading("ƒêang t·∫£i danh s√°ch t√†i kho·∫£n...");
            const accounts = await getAllAccountsFromGitHub();
            hideLoading();
            
            const accountList = document.getElementById('account-list');
            if (accounts.length === 0) {
                accountList.innerHTML = '<div style="text-align: center; color: #ccc; padding: 10px;">Ch∆∞a c√≥ t√†i kho·∫£n n√†o</div>';
            } else {
                accountList.innerHTML = accounts.map(account => `
                    <div class="account-item" onclick="quickLogin('${account.username}')">
                        <strong>${account.username}</strong>
                        <span class="cloud-badge">CLOUD</span>
                        <div style="font-size: 10px; color: #ccc;">${Math.round(account.size/1024)} KB</div>
                    </div>
                `).join('');
            }
            showNotification(`üìÇ ƒê√£ t·∫£i ${accounts.length} t√†i kho·∫£n t·ª´ Cloud`);
        }

        // ƒêƒÉng nh·∫≠p nhanh
        async function quickLogin(username) {
            showLoading(`ƒêang ƒëƒÉng nh·∫≠p ${username}...`);
            currentUser = username;
            
            // T·∫£i d·ªØ li·ªáu t·ª´ GitHub
            const success = await loadFromGitHub();
            
            if (success) {
                showNotification(`üéâ ƒê√£ ƒëƒÉng nh·∫≠p ${username} t·ª´ Cloud!`);
                showScreen('main-menu');
                updateUserInfo();
                updateUI();
            } else {
                showNotification('‚ùå Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ Cloud');
                currentUser = null;
            }
            hideLoading();
        }

        async function autoLoginAndPlay() {
            showLoading("ƒêang t·∫°o t√†i kho·∫£n t·ª± ƒë·ªông...");
            
            // T·∫°o t√†i kho·∫£n t·ª± ƒë·ªông
            const autoUsername = "Player_" + Math.floor(Math.random() * 10000);
            const autoPassword = "auto123";
            
            currentUser = autoUsername;
            
            // T·∫°o d·ªØ li·ªáu game m·ªõi
            initializeNewGameData();
            
            // L∆∞u l√™n GitHub ngay l·∫≠p t·ª©c
            showLoading("ƒêang l∆∞u t√†i kho·∫£n l√™n Cloud...");
            const saveSuccess = await saveToGitHub();
            
            if (saveSuccess) {
                showNotification(`üéâ T·∫°o t√†i kho·∫£n ${autoUsername} th√†nh c√¥ng tr√™n Cloud!`);
                showScreen('main-menu');
                updateUserInfo();
                updateUI();
            } else {
                showNotification('‚ùå Kh√¥ng th·ªÉ t·∫°o t√†i kho·∫£n tr√™n Cloud');
                currentUser = null;
            }
            hideLoading();
        }

        // H√†m l∆∞u l√™n GitHub
        async function saveToGitHub() {
            if (!currentUser) return false;
            
            try {
                const saveData = {
                    playerData: playerData,
                    gameState: {
                        ...gameState,
                        fishingSlots: gameState.fishingSlots.map(slot => ({
                            ...slot,
                            checkInterval: null,
                            finishTimeout: null,
                            fishCaught: slot.fishCaught || null
                        }))
                    },
                    timestamp: Date.now(),
                    version: "3.0-cloud",
                    user: currentUser
                };
                
                const safeEncode = (str) => {
                    return btoa(unescape(encodeURIComponent(str)));
                };
                
                const content = safeEncode(JSON.stringify(saveData));
                const filename = `fishing_game_${currentUser}.json`;
                
                let sha = null;
                try {
                    const getResponse = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${filename}`, {
                        headers: {
                            'Authorization': `token ${GITHUB_CONFIG.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (getResponse.ok) {
                        const fileData = await getResponse.json();
                        sha = fileData.sha;
                    }
                } catch (error) {
                    // File ch∆∞a t·ªìn t·∫°i
                }
                
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${filename}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Save game data for ${currentUser}`,
                        content: content,
                        sha: sha
                    })
                });
                
                return response.ok;
            } catch (error) {
                console.log('‚ùå L·ªói khi l∆∞u l√™n GitHub:', error.message);
                return false;
            }
        }

        // H√†m t·∫£i t·ª´ GitHub
        async function loadFromGitHub() {
            if (!currentUser) return false;
            
            try {
                const filename = `fishing_game_${currentUser}.json`;
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${filename}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (response.ok) {
                    const fileData = await response.json();
                    const content = atob(fileData.content);
                    const saveData = JSON.parse(content);
                    
                    // Load d·ªØ li·ªáu v√†o game t·ª´ GitHub
                    playerData = { ...playerData, ...saveData.playerData };
                    
                    const { fishingSlots, ...otherGameState } = saveData.gameState;
                    gameState = { ...gameState, ...otherGameState };
                    
                    gameState.fishingSlots = gameState.fishingSlots.map(slot => ({
                        ...slot,
                        checkInterval: null,
                        finishTimeout: null,
                        status: "Tr·ªëng",
                        fishCaught: slot.fishCaught || null
                    }));
                    
                    playerData.rodsInventory.forEach(rod => {
                        rod.status = "Tr·ªëng";
                    });
                    
                    return true;
                } else {
                    return false;
                }
            } catch (error) {
                console.log('‚ùå L·ªói khi t·∫£i t·ª´ GitHub:', error.message);
                return false;
            }
        }

        // H√†m x√≥a t√†i kho·∫£n kh·ªèi GitHub
        async function deleteAccountFromGitHub(username) {
            try {
                const filename = `fishing_game_${username}.json`;
                
                // L·∫•y SHA c·ªßa file
                const getResponse = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${filename}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_CONFIG.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (getResponse.ok) {
                    const fileData = await getResponse.json();
                    const sha = fileData.sha;
                    
                    // X√≥a file
                    const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/contents/${filename}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `token ${GITHUB_CONFIG.token}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `Delete account ${username}`,
                            sha: sha
                        })
                    });
                    
                    return response.ok;
                }
                return false;
            } catch (error) {
                console.log('‚ùå L·ªói khi x√≥a t√†i kho·∫£n:', error.message);
                return false;
            }
        }

        // C√°c h√†m ƒëƒÉng k√Ω/ƒëƒÉng nh·∫≠p - CH·ªà S·ª¨ D·ª§NG GITHUB
        async function register() {
            const username = document.getElementById('username').value || document.getElementById('account-username').value;
            const password = document.getElementById('password').value || document.getElementById('account-password').value;
            
            if (!username || !password) {
                showNotification('‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n v√† m·∫≠t kh·∫©u!');
                return;
            }
            
            showLoading("ƒêang ki·ªÉm tra t√†i kho·∫£n tr√™n Cloud...");
            
            // Ki·ªÉm tra xem t√†i kho·∫£n ƒë√£ t·ªìn t·∫°i tr√™n GitHub ch∆∞a
            currentUser = username;
            const accountExists = await loadFromGitHub();
            
            if (accountExists) {
                showNotification('‚ùå T√™n ng∆∞·ªùi d√πng ƒë√£ t·ªìn t·∫°i tr√™n Cloud!');
                currentUser = null;
                hideLoading();
                return;
            }
            
            // T·∫°o t√†i kho·∫£n m·ªõi
            showLoading("ƒêang t·∫°o t√†i kho·∫£n m·ªõi...");
            initializeNewGameData();
            
            // L∆∞u l√™n GitHub
            showLoading("ƒêang t·∫£i...");
            const saveSuccess = await saveToGitHub();
            
            if (saveSuccess) {
                showNotification('‚úÖ ƒêƒÉng k√Ω th√†nh c√¥ng!');
                
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('account-username').value = '';
                document.getElementById('account-password').value = '';
                
                showScreen('main-menu');
                updateUserInfo();
                updateUI();
            } else {
                showNotification('‚ùå L·ªói khi l∆∞u t√†i kho·∫£n');
                currentUser = null;
            }
            hideLoading();
        }

        async function login() {
            const username = document.getElementById('username').value || document.getElementById('account-username').value;
            const password = document.getElementById('password').value || document.getElementById('account-password').value;
            
            if (!username || !password) {
                showNotification('‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n v√† m·∫≠t kh·∫©u!');
                return;
            }
            
            showLoading("ƒêang ƒëƒÉng nh·∫≠p");
            
            currentUser = username;
            const loginSuccess = await loadFromGitHub();
            
            if (loginSuccess) {
                showNotification(`üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! Ch√†o ${username}`);
                
                // Hi·ªÉn th·ªã danh s√°ch t√†i kho·∫£n sau khi ƒëƒÉng nh·∫≠p th√†nh c√¥ng
                document.getElementById('account-list-container').style.display = 'block';
                setTimeout(() => {
                    listAllAccounts();
                }, 500);
                
                showScreen('main-menu');
                updateUserInfo();
                updateUI();
            } else {
                showNotification('‚ùå Sai t√™n ƒëƒÉng nh·∫≠p ho·∫∑c t√†i kho·∫£n kh√¥ng t·ªìn t·∫°i!');
                currentUser = null;
            }
            hideLoading();
        }

        async function deleteCurrentAccount() {
            if (!currentUser) {
                showNotification('‚ö†Ô∏è Kh√¥ng c√≥ t√†i kho·∫£n n√†o ƒëang ƒëƒÉng nh·∫≠p!');
                return;
            }
            
            if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën X√ìA vƒ©nh vi·ªÖn t√†i kho·∫£n "${currentUser}" kh·ªèi Cloud?`)) {
                return;
            }
            
            showLoading("ƒêang x√≥a t√†i kho·∫£n");
            const deleteSuccess = await deleteAccountFromGitHub(currentUser);
            
            if (deleteSuccess) {
                showNotification(`‚úÖ ƒê√£ x√≥a t√†i kho·∫£n "${currentUser}" kh·ªèi Cloud!`);
                logout();
            } else {
                showNotification('‚ùå L·ªói khi x√≥a t√†i kho·∫£n!');
            }
            hideLoading();
        }

        function logout() {
            currentUser = null;
            showNotification('üö™ ƒê√£ ƒëƒÉng xu·∫•t!');
            showScreen('login-screen');
            updateUserInfo();
            
            // ·∫®n danh s√°ch t√†i kho·∫£n khi ƒëƒÉng xu·∫•t
            document.getElementById('account-list-container').style.display = 'none';
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('user-info');
            const currentUserEl = document.getElementById('current-user');
            const mainUserEl = document.getElementById('main-user');
            const accountUserEl = document.getElementById('account-user');
            
            if (currentUser) {
                userInfo.style.display = 'block';
                currentUserEl.textContent = `üë§ ${currentUser} ‚òÅÔ∏è`;
                mainUserEl.textContent = `üë§ ${currentUser} ‚òÅÔ∏è`;
                accountUserEl.textContent = `üë§ ${currentUser} ‚òÅÔ∏è`;
            } else {
                userInfo.style.display = 'none';
                currentUserEl.textContent = 'Ch∆∞a ƒëƒÉng nh·∫≠p';
                mainUserEl.textContent = 'Ch∆∞a ƒëƒÉng nh·∫≠p';
                accountUserEl.textContent = 'Ch∆∞a ƒëƒÉng nh·∫≠p';
            }
        }

        // ========== D·ªÆ LI·ªÜU TR√í CH∆†I ==========
        let gameState = {
            currentScreen: "main-menu",
            currentLocation: null,
            currentChannel: null,
            lastFishingTime: 0,
            lastHpRegen: Date.now(),
            activeEvents: [],
            achievements: [],
            dailyRewards: {},
            fishingSlots: [
                { 
                    id: 0, 
                    status: "Tr·ªëng", 
                    rodId: null, 
                    startTime: 0,
                    endTime: 0,
                    checkInterval: null,
                    finishTimeout: null,
                    fishCaught: null
                },
                { 
                    id: 1, 
                    status: "Tr·ªëng", 
                    rodId: null, 
                    startTime: 0,
                    endTime: 0,
                    checkInterval: null,
                    finishTimeout: null,
                    fishCaught: null
                }
            ]
        };

        let playerData = {
            level: 1,
            exp: 0,
            coins: 1500,
            gems: 0,
            health: 100,
            maxHealth: 100,
            points: 0,
            fishInventory: [],
            rodsInventory: [
                { 
                    id: 1, 
                    name: "C·∫ßn Tre", 
                    level: 1, 
                    status: "Tr·ªëng",
                    rarity: "common",
                    maxFishingTime: 10 * 60 * 1000,
                    type: "bamboo"
                },
                { 
                    id: 2, 
                    name: "C·∫ßn Tre", 
                    level: 1, 
                    status: "Tr·ªëng",
                    rarity: "common",
                    maxFishingTime: 10 * 60 * 1000,
                    type: "bamboo"
                }
            ],
            itemsInventory: [],
            maxRods: 5,
            skills: {
                fishing: 1,
                luck: 1,
                endurance: 1
            },
            statistics: {
                totalFishCaught: 0,
                biggestFish: 0,
                totalEarnings: 0,
                playTime: 0
            }
        };

        // Th√¥ng tin khu v·ª±c c√¢u c√°
        const fishingLocations = {
            "Khu ƒê·ªìng L·ªõn": {
                successRate: 0.15,
                minWeight: 0.1,
                maxWeight: 2.0,
                requiredLevel: 1
            },
            "Khu R·ª´ng Tr√†m": {
                successRate: 0.10,
                minWeight: 0.5,
                maxWeight: 3.0,
                requiredLevel: 7
            },
            "H·ªì Thi√™ng": {
                successRate: 0.05,
                minWeight: 1.0,
                maxWeight: 5.0,
                requiredLevel: 15
            }
        };

        // H·ªá th·ªëng s·ª± ki·ªán
        const events = {
            doubleExp: {
                name: "Double EXP",
                description: "Nh·∫≠n g·∫•p ƒë√¥i kinh nghi·ªám khi b·∫Øt c√°",
                active: false,
                multiplier: 2.0,
                color: "double-exp",
                effect: "exp"
            },
            luckyDay: {
                name: "Ng√†y May M·∫Øn",
                description: "TƒÉng 50% t·ª∑ l·ªá b·∫Øt c√° v√† c√° l·ªõn h∆°n",
                active: false,
                multiplier: 1.5,
                color: "lucky-day",
                effect: "luck"
            },
            goldenFish: {
                name: "C√° V√†ng",
                description: "C√≥ c∆° h·ªôi b·∫Øt ƒë∆∞·ª£c c√° v√†ng gi√° tr·ªã cao",
                active: false,
                multiplier: 1.0,
                color: "golden-fish",
                effect: "golden"
            }
        };

        // ========== H·ªÜ TH·ªêNG L∆ØU GAME - CH·ªà GITHUB ==========
        function initializeNewGameData() {
            playerData = {
                level: 1,
                exp: 0,
                coins: 1500,
                gems: 0,
                health: 100,
                maxHealth: 100,
                points: 0,
                fishInventory: [],
                rodsInventory: [
                    { 
                        id: 1, 
                        name: "C·∫ßn Tre", 
                        level: 1, 
                        status: "Tr·ªëng",
                        rarity: "common",
                        maxFishingTime: 10 * 60 * 1000,
                        type: "bamboo"
                    },
                    { 
                        id: 2, 
                        name: "C·∫ßn Tre", 
                        level: 1, 
                        status: "Tr·ªëng",
                        rarity: "common",
                        maxFishingTime: 10 * 60 * 1000,
                        type: "bamboo"
                    }
                ],
                itemsInventory: [],
                maxRods: 5,
                skills: {
                    fishing: 1,
                    luck: 1,
                    endurance: 1
                },
                statistics: {
                    totalFishCaught: 0,
                    biggestFish: 0,
                    totalEarnings: 0,
                    playTime: 0
                }
            };

            gameState = {
                currentScreen: "main-menu",
                currentLocation: null,
                currentChannel: null,
                lastFishingTime: 0,
                lastHpRegen: Date.now(),
                activeEvents: [],
                achievements: [],
                dailyRewards: {},
                fishingSlots: [
                    { 
                        id: 0, 
                        status: "Tr·ªëng", 
                        rodId: null, 
                        startTime: 0,
                        endTime: 0,
                        checkInterval: null,
                        finishTimeout: null,
                        fishCaught: null
                    },
                    { 
                        id: 1, 
                        status: "Tr·ªëng", 
                        rodId: null, 
                        startTime: 0,
                        endTime: 0,
                        checkInterval: null,
                        finishTimeout: null,
                        fishCaught: null
                    }
                ]
            };
        }

        function saveGame() {
            if (!currentUser) return;
            
            // CH·ªà L∆ØU L√äN GITHUB, KH√îNG L∆ØU LOCAL
            setTimeout(() => {
                saveToGitHub().then(success => {
                    if (success) {
                        console.log('‚úÖ ƒê√£ l∆∞u game');
                    } else {
                        console.log('‚ùå L·ªói khi l∆∞u game!');
                    }
                });
            }, 500);
        }

        // ========== H√ÄM C∆† B·∫¢N ==========
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                gameState.currentScreen = screenId;
            }
            
            updateUI();
        }

        // ========== H·ªÜ TH·ªêNG C√ÇU C√Å ==========
        function startFishing(slotIndex) {
            const freeRod = playerData.rodsInventory.find(rod => rod.status === "Tr·ªëng");
            if (!freeRod) {
                showNotification("üé£ Kh√¥ng c√≥ c·∫ßn c√¢u tr·ªëng!");
                return;
            }

            if (!gameState.currentLocation) {
                showNotification("‚ö†Ô∏è Vui l√≤ng ch·ªçn khu v·ª±c c√¢u c√°!");
                return;
            }

            const slot = gameState.fishingSlots[slotIndex];
            if (slot.checkInterval) {
                clearInterval(slot.checkInterval);
            }
            if (slot.finishTimeout) {
                clearTimeout(slot.finishTimeout);
            }

            freeRod.status = "ƒêang c√¢u";
            slot.status = "ƒêang c√¢u";
            slot.rodId = freeRod.id;
            slot.startTime = Date.now();
            slot.endTime = Date.now() + freeRod.maxFishingTime;
            slot.fishCaught = null;

            showNotification(`üé£ ƒê√£ c·∫Øm c·∫ßn t·∫°i ${gameState.currentLocation}!`);
            updateUI();

            // Ki·ªÉm tra c√° d√≠nh c√¢u sau m·ªói 1 ph√∫t
            slot.checkInterval = setInterval(() => {
                checkForFish(slotIndex);
            }, 60000); // 60000ms = 1 ph√∫t

            slot.finishTimeout = setTimeout(() => {
                finishFishing(slotIndex);
            }, freeRod.maxFishingTime);
            
            saveGame();
        }

        function checkForFish(slotIndex) {
            const slot = gameState.fishingSlots[slotIndex];
            const rod = playerData.rodsInventory.find(r => r.id === slot.rodId);
            
            if (!rod || rod.status !== "ƒêang c√¢u") return;

            const location = fishingLocations[gameState.currentLocation];
            let successRate = location.successRate;
            let minWeight = location.minWeight;
            let maxWeight = location.maxWeight;

            if (events.luckyDay.active) {
                successRate *= events.luckyDay.multiplier;
                minWeight *= 1.2;
                maxWeight *= 1.2;
            }

            if (Math.random() < successRate) {
                const weightRange = maxWeight - minWeight;
                const weight = minWeight + (Math.random() * weightRange);
                const finalWeight = parseFloat(weight.toFixed(2));
                
                let expGained = Math.floor(finalWeight * 20);
                let value = Math.floor(finalWeight * 100);
                
                let fishName = "C√° L√≥c";
                let rarity = finalWeight > (maxWeight * 0.8) ? "rare" : "common";
                
                if (events.goldenFish.active && Math.random() < 0.1) {
                    fishName = "üê† C√° V√†ng";
                    value *= 5;
                    expGained *= 3;
                    rarity = "golden";
                }
                
                if (events.doubleExp.active) {
                    expGained = Math.floor(expGained * events.doubleExp.multiplier);
                }
                
                const fish = {
                    name: fishName,
                    weight: finalWeight,
                    exp: expGained,
                    value: value,
                    rarity: rarity
                };
                
                // L∆∞u c√° v√†o slot thay v√¨ tr·ª±c ti·∫øp v√†o t√∫i ƒë·ªì
                slot.fishCaught = fish;
                slot.status = "C√° d√≠nh c√¢u!";
                
                // Hi·ªÉn th·ªã ch·ªâ b√°o c√° d√≠nh c√¢u
                const indicator = document.getElementById('fish-caught-indicator');
                indicator.style.display = 'block';
                
                showNotification(`üé£ C√Å D√çNH C√ÇU! H√£y thu c√¢u ngay!`);
                
                updateUI();
                saveGame();
            }
        }

        function collectFishing(slotIndex) {
            const slot = gameState.fishingSlots[slotIndex];
            
            if (slot.status === "C√° d√≠nh c√¢u!" && slot.fishCaught) {
                // Th√™m c√° v√†o t√∫i ƒë·ªì
                const fish = slot.fishCaught;
                playerData.fishInventory.push(fish);
                playerData.exp += fish.exp;
                
                playerData.statistics.totalFishCaught++;
                if (fish.weight > playerData.statistics.biggestFish) {
                    playerData.statistics.biggestFish = fish.weight;
                }
                
                checkLevelUp();
                
                let rarityText = "";
                if (fish.rarity === "rare") {
                    rarityText = " üéâ HI·∫æM!";
                } else if (fish.rarity === "golden") {
                    rarityText = " ‚ú® C√Å V√ÄNG!";
                }
                
                showNotification(`üé£ B·∫Øt ƒë∆∞·ª£c ${fish.name} ${fish.weight}kg! +${fish.exp} EXP${rarityText}`);
                
                // ·∫®n ch·ªâ b√°o c√° d√≠nh c√¢u
                const indicator = document.getElementById('fish-caught-indicator');
                indicator.style.display = 'none';
                
                // K·∫øt th√∫c c√¢u c√°
                finishFishing(slotIndex);
            } else if (slot.status === "ƒêang c√¢u") {
                finishFishing(slotIndex);
            }
        }

        function finishFishing(slotIndex) {
            const slot = gameState.fishingSlots[slotIndex];
            const rod = playerData.rodsInventory.find(r => r.id === slot.rodId);
            
            if (slot.checkInterval) {
                clearInterval(slot.checkInterval);
                slot.checkInterval = null;
            }
            if (slot.finishTimeout) {
                clearTimeout(slot.finishTimeout);
                slot.finishTimeout = null;
            }
            
            if (rod) {
                rod.status = "Tr·ªëng";
            }
            
            slot.status = "Tr·ªëng";
            slot.rodId = null;
            slot.startTime = 0;
            slot.endTime = 0;
            slot.fishCaught = null;
            
            // ·∫®n ch·ªâ b√°o c√° d√≠nh c√¢u
            const indicator = document.getElementById('fish-caught-indicator');
            indicator.style.display = 'none';
            
            showNotification("üé£ ƒê√£ thu c·∫ßn!");
            saveGame();
            updateUI();
        }

        // ========== H·ªÜ TH·ªêNG THƒÇM TR·ªòM ==========
        function startStealing() {
            if (playerData.health >= 20) {
                playerData.health -= 20;
                
                if (Math.random() > 0.5) {
                    const weight = (Math.random() * 2 + 0.5).toFixed(2);
                    const value = Math.floor(weight * 80);
                    
                    playerData.fishInventory.push({
                        name: "C√° Tr·ªôm",
                        weight: parseFloat(weight),
                        exp: Math.floor(weight * 15),
                        value: value,
                        rarity: "stolen"
                    });
                    
                    showNotification(`üïµÔ∏è Tr·ªôm th√†nh c√¥ng! B·∫Øt ƒë∆∞·ª£c c√° ${weight}kg! +${value}üí∞`);
                } else {
                    showNotification("üïµÔ∏è Tr·ªôm th·∫•t b·∫°i! B·ªã ph√°t hi·ªán!");
                }
                
                saveGame();
                showScreen("main-menu");
            } else {
                showNotification("‚ö†Ô∏è Kh√¥ng ƒë·ªß HP ƒë·ªÉ thƒÉm tr·ªôm!");
            }
        }

        // ========== H·ªÜ TH·ªêNG MUA B√ÅN ==========
        function buyRod(type) {
            let cost, rod;
            
            switch(type) {
                case 'iron':
                    cost = 10000;
                    rod = {
                        id: playerData.rodsInventory.length + 1,
                        name: "C·∫ßn S·∫Øt",
                        level: 1,
                        status: "Tr·ªëng",
                        rarity: "uncommon",
                        maxFishingTime: 15 * 60 * 1000,
                        type: "iron"
                    };
                    break;
                case 'gold':
                    cost = 50000;
                    rod = {
                        id: playerData.rodsInventory.length + 1,
                        name: "C·∫ßn V√†ng",
                        level: 1,
                        status: "Tr·ªëng",
                        rarity: "rare",
                        maxFishingTime: 20 * 60 * 1000,
                        type: "gold"
                    };
                    break;
                default:
                    return;
            }
            
            if (playerData.coins >= cost) {
                if (playerData.rodsInventory.length < playerData.maxRods) {
                    playerData.coins -= cost;
                    playerData.rodsInventory.push(rod);
                    saveGame();
                    showNotification(`üé£ Mua ${rod.name} th√†nh c√¥ng!`);
                } else {
                    showNotification("üé£ ƒê√£ ƒë·∫°t gi·ªõi h·∫°n s·ªë l∆∞·ª£ng c·∫ßn c√¢u!");
                }
            } else {
                showNotification(`üí∞ Kh√¥ng ƒë·ªß xu! C·∫ßn ${cost.toLocaleString()}üí∞`);
            }
            updateUI();
        }

        function upgradeRodLimit() {
            const cost = 50000;
            if (playerData.coins >= cost && playerData.maxRods < 10) {
                playerData.coins -= cost;
                playerData.maxRods++;
                saveGame();
                showNotification(`üé£ N√¢ng c·∫•p th√†nh c√¥ng! Gi·ªõi h·∫°n: ${playerData.maxRods} c·∫ßn`);
            } else if (playerData.maxRods >= 10) {
                showNotification("üé£ ƒê√£ ƒë·∫°t gi·ªõi h·∫°n t·ªëi ƒëa!");
            } else {
                showNotification(`üí∞ Kh√¥ng ƒë·ªß xu! C·∫ßn ${cost.toLocaleString()}üí∞`);
            }
            updateUI();
        }

        function sellAllFish() {
            if (playerData.fishInventory.length === 0) {
                showNotification("üêü Kh√¥ng c√≥ c√° ƒë·ªÉ b√°n!");
                return;
            }
            
            const totalValue = playerData.fishInventory.reduce((sum, fish) => sum + fish.value, 0);
            playerData.coins += totalValue;
            playerData.statistics.totalEarnings += totalValue;
            
            showNotification(`üí∞ B√°n th√†nh c√¥ng ${playerData.fishInventory.length} con c√°! +${totalValue}üí∞`);
            
            playerData.fishInventory = [];
            saveGame();
            updateUI();
        }

        // ========== H·ªÜ TH·ªêNG K·ª∏ NƒÇNG ==========
        function upgradeSkill(skill) {
            const upgradeCost = playerData.skills[skill] * 100;
            
            if (playerData.coins >= upgradeCost) {
                playerData.coins -= upgradeCost;
                playerData.skills[skill]++;
                saveGame();
                showNotification(`‚≠ê N√¢ng c·∫•p ${skill} th√†nh c√¥ng!`);
                updateUI();
            } else {
                showNotification(`üí∞ C·∫ßn ${upgradeCost} xu ƒë·ªÉ n√¢ng c·∫•p`);
            }
        }

        // ========== H·ªÜ TH·ªêNG S·ª∞ KI·ªÜN ==========
        function checkRandomEvents() {
            if (Math.random() < 0.08 && gameState.activeEvents.length === 0) {
                const eventKeys = Object.keys(events);
                const randomEvent = eventKeys[Math.floor(Math.random() * eventKeys.length)];
                activateEvent(randomEvent);
            }
        }

        function activateEvent(eventKey) {
            const event = events[eventKey];
            event.active = true;
            gameState.activeEvents.push(eventKey);
            
            const eventBanner = document.getElementById('event-banner');
            eventBanner.textContent = `üéâ ${event.name}: ${event.description}`;
            eventBanner.className = `event-banner ${event.color}`;
            eventBanner.style.display = 'block';
            
            const eventEffect = document.getElementById('event-effect');
            eventEffect.classList.add('active');
            
            showNotification(`üéâ S·ª± ki·ªán ${event.name} ƒë√£ b·∫Øt ƒë·∫ßu!`);
            
            const duration = (3 + Math.random() * 4) * 60000;
            setTimeout(() => {
                deactivateEvent(eventKey);
            }, duration);
        }

        function deactivateEvent(eventKey) {
            const event = events[eventKey];
            event.active = false;
            gameState.activeEvents = gameState.activeEvents.filter(e => e !== eventKey);
            
            const eventBanner = document.getElementById('event-banner');
            eventBanner.style.display = 'none';
            
            const eventEffect = document.getElementById('event-effect');
            eventEffect.classList.remove('active');
            
            showNotification(`‚è∞ S·ª± ki·ªán ${event.name} ƒë√£ k·∫øt th√∫c`);
        }

        // ========== H·ªÜ TH·ªêNG LEVEL ==========
        function checkLevelUp() {
            const expNeeded = calculateExpNeeded();
            if (playerData.exp >= expNeeded) {
                playerData.level++;
                playerData.exp -= expNeeded;
                playerData.maxHealth += 10;
                playerData.health = playerData.maxHealth;
                saveGame();
                showNotification(`üéâ CH√öC M·ª™NG! L√äN C·∫§P ${playerData.level}!`);
            }
        }

        function calculateExpNeeded() {
            return Math.floor(100 * Math.pow(playerData.level, 1.5));
        }

        // ========== CH·ªåN KHU V·ª∞C ==========
        function selectLocation(location) {
            const locationInfo = fishingLocations[location];
            if (locationInfo && playerData.level >= locationInfo.requiredLevel) {
                gameState.currentLocation = location;
                document.getElementById("channel-location").textContent = `KHU V·ª∞C: ${location}`;
                showScreen("select-channel");
            } else {
                showNotification(`üîí C·∫ßn ƒë·∫°t c·∫•p ${locationInfo.requiredLevel} ƒë·ªÉ m·ªü kh√≥a khu v·ª±c n√†y!`);
            }
        }

        function selectChannel(channel) {
            gameState.currentChannel = channel;
            document.getElementById("fishing-location").textContent = `${gameState.currentLocation} - ${channel}`;
            showScreen("fishing-screen");
        }

        // ========== C·∫¨P NH·∫¨T GIAO DI·ªÜN ==========
        function updateUI() {
            updateHp();
            
            document.getElementById("player-level").textContent = playerData.level;
            document.getElementById("player-coins").textContent = playerData.coins.toLocaleString();
            document.getElementById("player-hp").textContent = playerData.health;
            document.getElementById("player-fish").textContent = playerData.fishInventory.length;
            document.getElementById("player-points").textContent = playerData.points;
            
            document.getElementById("char-level").textContent = playerData.level;
            document.getElementById("char-coins").textContent = playerData.coins.toLocaleString();
            document.getElementById("char-hp").textContent = playerData.health;
            document.getElementById("steal-hp").textContent = playerData.health;
            document.getElementById("location-level").textContent = playerData.level;
            
            const hpPercent = (playerData.health / playerData.maxHealth) * 100;
            document.getElementById("char-hp-fill").style.width = `${hpPercent}%`;
            
            const expNeeded = calculateExpNeeded();
            const expPercent = (playerData.exp / expNeeded) * 100;
            document.getElementById("char-exp").textContent = playerData.exp.toLocaleString();
            document.getElementById("char-exp-needed").textContent = expNeeded.toLocaleString();
            document.getElementById("char-exp-fill").style.width = `${expPercent}%`;
            
            const fishCount = playerData.fishInventory.length;
            const fishWeight = playerData.fishInventory.reduce((sum, fish) => sum + fish.weight, 0);
            document.getElementById("fish-caught").textContent = fishCount;
            document.getElementById("fish-weight").textContent = fishWeight.toFixed(2);
            document.getElementById("fishing-fish-count").textContent = fishCount;
            document.getElementById("biggest-fish").textContent = playerData.statistics.biggestFish.toFixed(2);
            
            document.getElementById("skill-fishing").textContent = playerData.skills.fishing;
            document.getElementById("skill-luck").textContent = playerData.skills.luck;
            document.getElementById("skill-endurance").textContent = playerData.skills.endurance;
            
            const freeRods = playerData.rodsInventory.filter(r => r.status === "Tr·ªëng").length;
            document.getElementById("inventory-rods-count").textContent = playerData.rodsInventory.length;
            document.getElementById("inventory-max-rods").textContent = playerData.maxRods;
            document.getElementById("free-rods").textContent = freeRods;
            document.getElementById("fishing-max-rods").textContent = playerData.maxRods;
            document.getElementById("current-rod-limit").textContent = playerData.maxRods;
            
            document.getElementById("shop-coins").textContent = playerData.coins.toLocaleString();
            document.getElementById("inventory-coins").textContent = playerData.coins.toLocaleString();
            document.getElementById("sell-coins").textContent = playerData.coins.toLocaleString();
            
            const totalFishValue = playerData.fishInventory.reduce((sum, fish) => sum + fish.value, 0);
            document.getElementById("total-fish-value").textContent = totalFishValue.toLocaleString();
            
            updateRodsList();
            updateFishList();
            updateFishingSlots();
            updateEventInfo();
            updateLocationAccess();
        }

        function updateHp() {
            const now = Date.now();
            const timeDiffHp = now - gameState.lastHpRegen;
            const hpGain = Math.floor(timeDiffHp / 60000);
            
            if (hpGain > 0) {
                playerData.health = Math.min(playerData.maxHealth, playerData.health + hpGain);
                gameState.lastHpRegen = now;
            }
        }

        function updateLocationAccess() {
            const locations = document.querySelectorAll('.location-slot');
            locations.forEach(location => {
                const locationName = location.querySelector('strong').textContent;
                const locationInfo = fishingLocations[locationName];
                
                if (locationInfo && playerData.level >= locationInfo.requiredLevel) {
                    location.classList.remove('inactive');
                    location.classList.add('active');
                } else {
                    location.classList.remove('active');
                    location.classList.add('inactive');
                }
            });
        }

        function updateRodsList() {
            const rodsContainer = document.getElementById("rods-container");
            if (rodsContainer) {
                rodsContainer.innerHTML = '';
                
                playerData.rodsInventory.forEach(rod => {
                    const rodElement = document.createElement("div");
                    rodElement.className = "inventory-item rod-item";
                    
                    let rarityBadge = "";
                    if (rod.rarity === "uncommon") rarityBadge = '<span class="badge">UNCOMMON</span>';
                    if (rod.rarity === "rare") rarityBadge = '<span class="badge premium">RARE</span>';
                    
                    const maxMinutes = rod.maxFishingTime / (60 * 1000);
                    
                    rodElement.innerHTML = `
                        <div>
                            <strong>${rod.name}</strong> ${rarityBadge}
                            <div style="font-size: 12px; color: #ccc;">
                                Th·ªùi gian: ${maxMinutes} ph√∫t
                            </div>
                        </div>
                        <div>
                            ${rod.status}
                        </div>
                    `;
                    
                    rodsContainer.appendChild(rodElement);
                });
            }
        }

        function updateFishList() {
            const fishContainer = document.getElementById("fish-container");
            const sellFishContainer = document.getElementById("sell-fish-container");
            
            if (fishContainer) {
                fishContainer.innerHTML = '';
                
                if (playerData.fishInventory.length === 0) {
                    fishContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ccc;">Ch∆∞a c√≥ c√° trong kho</div>';
                } else {
                    playerData.fishInventory.forEach((fish, index) => {
                        const fishElement = document.createElement("div");
                        fishElement.className = "inventory-item fish-item";
                        
                        let rarityText = "";
                        if (fish.rarity === "rare") rarityText = '<span class="badge new">HI·∫æM</span>';
                        if (fish.rarity === "stolen") rarityText = '<span class="badge">TR·ªòM</span>';
                        if (fish.rarity === "golden") rarityText = '<span class="badge premium">V√ÄNG</span>';
                        
                        fishElement.innerHTML = `
                            <div>
                                <strong>${fish.name}</strong> ${rarityText}
                                <div style="font-size: 12px; color: #ccc;">
                                    ${fish.weight} kg | Gi√°: ${fish.value}üí∞
                                </div>
                            </div>
                        `;
                        
                        fishContainer.appendChild(fishElement);
                    });
                }
            }
            
            if (sellFishContainer) {
                sellFishContainer.innerHTML = '';
                
                if (playerData.fishInventory.length === 0) {
                    sellFishContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #ccc;">Kh√¥ng c√≥ c√° ƒë·ªÉ b√°n</div>';
                } else {
                    const totalWeight = playerData.fishInventory.reduce((sum, fish) => sum + fish.weight, 0);
                    const totalValue = playerData.fishInventory.reduce((sum, fish) => sum + fish.value, 0);
                    
                    sellFishContainer.innerHTML = `
                        <div class="inventory-item">
                            <div>
                                <strong>T·ªïng c·ªông</strong>
                                <div style="font-size: 12px; color: #ccc;">
                                    ${playerData.fishInventory.length} con c√° | ${totalWeight.toFixed(2)} kg
                                </div>
                            </div>
                            <div>
                                <strong>${totalValue}üí∞</strong>
                            </div>
                        </div>
                    `;
                }
            }
        }

        function updateFishingSlots() {
            gameState.fishingSlots.forEach((slot, index) => {
                const slotElement = document.getElementById(`slot-${index+1}-status`);
                const timerElement = document.getElementById(`slot-${index+1}-timer`);
                const buttonElement = document.getElementById(`slot-${index+1}-button`);
                
                if (slotElement && timerElement && buttonElement) {
                    if (slot.status === "ƒêang c√¢u") {
                        const timeLeft = Math.ceil((slot.endTime - Date.now()) / 1000);
                        if (timeLeft > 0) {
                            const minutes = Math.floor(timeLeft / 60);
                            const seconds = timeLeft % 60;
                            slotElement.textContent = "ƒêang c√¢u c√°...";
                            timerElement.textContent = `‚è∞ ${minutes}:${seconds.toString().padStart(2, '0')}`;
                            buttonElement.textContent = "üé£ THU C√ÇN";
                            buttonElement.onclick = function() { collectFishing(index); };
                        } else {
                            finishFishing(index);
                        }
                    } else if (slot.status === "C√° d√≠nh c√¢u!") {
                        slotElement.textContent = "C√Å D√çNH C√ÇU!";
                        timerElement.textContent = "üé£ H√ÉY THU C√ÇU NGAY!";
                        buttonElement.textContent = "üé£ THU C√ÇU";
                        buttonElement.onclick = function() { collectFishing(index); };
                    } else {
                        slotElement.textContent = "Tr·ªëng";
                        timerElement.textContent = "";
                        buttonElement.textContent = "üé£ C·∫ÆM C√ÇU";
                        buttonElement.onclick = function() { startFishing(index); };
                    }
                }
            });
        }

        function updateEventInfo() {
            const activeEventsCount = gameState.activeEvents.length;
            if (activeEventsCount > 0) {
                const eventBanner = document.getElementById('event-banner');
                if (eventBanner.style.display === 'none') {
                    const mainEvent = events[gameState.activeEvents[0]];
                    eventBanner.textContent = `üéâ ${mainEvent.name} ƒêANG DI·ªÑN RA!`;
                    eventBanner.className = `event-banner ${mainEvent.color}`;
                    eventBanner.style.display = 'block';
                }
            }
        }

        // ========== KH·ªûI T·∫†O GAME ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üéÆ Game C·∫Øm C√¢u C√° L√≥c - Cloud Edition");
            
            showScreen('login-screen');
            updateUserInfo();
            updateUI();
            
            setTimeout(() => {
                showNotification("üé£ Ch√†o m·ª´ng ƒë·∫øn v·ªõi C·∫Øm C√¢u C√° L√≥c Cloud Edition!");
            }, 1000);
            
            // T·ª± ƒë·ªông l∆∞u game m·ªói 30 gi√¢y
            setInterval(saveGame, 30000);
            setInterval(updateUI, 1000);
            setInterval(updateFishingSlots, 1000);
            setInterval(checkRandomEvents, 30000);
        });
    </script>
</body>
</html>