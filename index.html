<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cắm Câu Cá Lóc</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a640a, #1e7c1e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        #game-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            min-height: 100vh;
        }
        
        .screen {
            display: none;
            width: 100%;
        }
        
        .active {
            display: block;
        }
        
        h1, h2, h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #ffc800;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background-color: rgba(50, 50, 50, 0.8);
            padding: 12px;
            border-radius: 10px;
            font-size: 14px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .button {
            display: block;
            width: 100%;
            padding: 16px;
            margin: 10px 0;
            background-color: #ffc800;
            color: black;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .button.red {
            background-color: #c80000;
            color: white;
        }
        
        .button.blue {
            background-color: #0046a0;
            color: white;
        }
        
        .button.green {
            background-color: #0a640a;
            color: white;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #646464;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s;
        }
        
        .hp-bar .progress-fill {
            background-color: #ff0000;
        }
        
        .exp-bar .progress-fill {
            background-color: #00ffff;
        }
        
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 1000;
            display: none;
            width: 80%;
            max-width: 300px;
        }
        
        .message.active {
            display: block;
        }
        
        .back-button {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Màn hình chính -->
        <div id="main-menu" class="screen active">
            <h1>CẮM CÂU CÁ LÓC</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Cấp: <span id="player-level">1</span></div>
                </div>
                <div class="stat-item">
                    <div>Xu: <span id="player-coins">1000</span></div>
                </div>
                <div class="stat-item">
                    <div>HP: <span id="player-hp">100</span>/100</div>
                </div>
            </div>
            
            <button class="button blue" id="char-info-btn">THÔNG TIN NHÂN VẬT</button>
            <button class="button" id="inventory-btn">TÚI ĐỒ & SHOP</button>
            <button class="button green" id="fishing-btn">ĐI CẮM CÂU</button>
            <button class="button red" id="steal-btn">THĂM TRỘM CẦN (Tốn 20 HP)</button>
        </div>
        
        <!-- Màn hình thông tin nhân vật -->
        <div id="character-screen" class="screen">
            <h1>THÔNG TIN NHÂN VẬT</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Tên: <span id="player-name">Ngư Phủ Làng Chài</span></div>
                </div>
                <div class="stat-item">
                    <div>Cấp: <span id="char-level">1</span></div>
                </div>
                <div class="stat-item">
                    <div>Xu: <span id="char-coins">1000</span></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>HP: <span id="char-hp">100</span>/100</div>
                <div class="progress-bar hp-bar">
                    <div class="progress-fill" id="hp-fill" style="width: 100%"></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>EXP: <span id="char-exp">0</span>/<span id="char-exp-needed">100</span></div>
                <div class="progress-bar exp-bar">
                    <div class="progress-fill" id="exp-fill" style="width: 0%"></div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div>Cá đã bắt: <span id="fish-caught">0</span> con (<span id="fish-weight">0.00</span> kg)</div>
            </div>
            
            <button class="button back-button" id="char-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình túi đồ -->
        <div id="inventory-screen" class="screen">
            <h1>TÚI ĐỒ</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Cần câu: <span id="rods-count">5</span>/<span id="max-rods">5</span></div>
                </div>
                <div class="stat-item">
                    <div>Xu: <span id="inventory-coins">1000</span></div>
                </div>
            </div>
            
            <div id="rods-list" style="margin: 20px 0;">
                <h3>Cần Câu Của Bạn</h3>
                <div id="rods-container"></div>
            </div>
            
            <button class="button green" id="shop-btn">CỬA HÀNG</button>
            <button class="button red" id="sell-fish-btn">BÁN CÁ</button>
            
            <button class="button back-button" id="inventory-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình cửa hàng -->
        <div id="shop-screen" class="screen">
            <h1>CỬA HÀNG</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Xu hiện tại: <span id="shop-coins">1000</span></div>
                </div>
            </div>
            
            <button class="button" id="buy-rod-btn">MUA CẦN SẮT - 10,000 Xu</button>
            <button class="button blue" id="upgrade-limit-btn">MỞ GIỚI HẠN CẦN CÂU - 50,000 Xu</button>
            
            <button class="button back-button" id="shop-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình bán cá -->
        <div id="sell-fish-screen" class="screen">
            <h1>BÁN CÁ CHO THƯƠNG LÁI</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Xu hiện tại: <span id="sell-coins">1000</span></div>
                </div>
            </div>
            
            <div style="margin: 15px 0;">
                <div>Giá bán Cá Lóc: 100 Xu/kg</div>
            </div>
            
            <div id="fish-list" style="margin: 20px 0;">
                <div class="inventory-item">
                    <div>Cá Lóc</div>
                    <div>0 con (0.00 kg)</div>
                </div>
            </div>
            
            <button class="button back-button" id="sell-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình chọn khu vực -->
        <div id="select-location" class="screen">
            <h1>CHỌN KHU VỰC CẮM CÂU</h1>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div>Cấp hiện tại: <span id="location-level">1</span></div>
                </div>
            </div>
            
            <div class="location-grid">
                <button class="button location-slot active" data-location="Khu Đồng Lớn">
                    <div>Khu Đồng Lớn</div>
                    <div>(Yêu cầu Lv: 1)</div>
                </button>
                <button class="button location-slot inactive" data-location="Khu Rừng Tràm">
                    <div>Khu Rừng Tràm</div>
                    <div>(Yêu cầu Lv: 7)</div>
                </button>
            </div>
            
            <button class="button back-button" id="location-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình chọn kênh -->
        <div id="select-channel" class="screen">
            <h1 id="channel-location">KHU VỰC: Khu Đồng Lớn</h1>
            <h2>CHỌN KÊNH</h2>
            
            <div class="location-grid">
                <button class="button location-slot active" data-channel="Kênh A">Kênh A</button>
                <button class="button location-slot active" data-channel="Kênh B">Kênh B</button>
            </div>
            
            <button class="button back-button" id="channel-back-btn">Quay Lại</button>
        </div>
        
        <!-- Màn hình câu cá -->
        <div id="fishing-screen" class="screen">
            <h1 id="fishing-location">Khu Đồng Lớn - Kênh A</h1>
            
            <div id="fishing-slots" style="margin: 20px 0;">
                <div class="fishing-slot">
                    <div>Ô cắm câu 1</div>
                    <button class="button" data-slot="0">Cắm Câu</button>
                </div>
            </div>
            
            <div class="stats-bar" style="margin-top: 15px;">
                <div class="stat-item">
                    <div>Cần Trống: <span id="free-rods">5</span>/<span id="fishing-max-rods">5</span></div>
                </div>
                <div class="stat-item">
                    <div>Cá đã bắt: <span id="fishing-fish-count">0</span> con</div>
                </div>
            </div>
            
            <button class="button back-button" id="fishing-back-btn">Quay Lại Kênh</button>
        </div>
        
        <!-- Màn hình xác nhận thăm trộm -->
        <div id="steal-menu" class="screen">
            <h1>XÁC NHẬN THĂM TRỘM CẦN</h1>
            
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 18px; margin-bottom: 15px;">Hành động này tốn 20 HP. Bạn có chắc muốn đi luôn không?</div>
                <div style="font-size: 16px;">HP hiện tại: <span id="steal-hp">100</span>/100</div>
            </div>
            
            <button class="button red" id="go-steal-btn">ĐI LUÔN</button>
            <button class="button blue back-button" id="steal-back-btn">SUY NGHĨ LẠI</button>
        </div>
        
        <!-- Màn hình thăm trộm -->
        <div id="steal-slots" class="screen">
            <h1>CHỌN CẦN NGƯỜI KHÁC ĐANG CẮM</h1>
            
            <div style="text-align: center; margin-bottom: 15px;">
                <div>Chọn 1 trong 3 ô cắm trộm (Chỉ được chọn 1 lần)</div>
            </div>
            
            <div id="steal-slots-container" style="margin: 20px 0;">
                <button class="button steal-slot" data-slot="0">Ô 1 - Đang cắm</button>
                <button class="button steal-slot" data-slot="1">Ô 2 - Đang cắm</button>
                <button class="button steal-slot" data-slot="2">Ô 3 - Đang cắm</button>
            </div>
            
            <button class="button back-button" id="steal-slots-back-btn">QUAY LẠI MÀN HÌNH CHÍNH</button>
        </div>
    </div>
    
    <!-- Thông báo -->
    <div id="message" class="message">
        <div id="message-text">Thông báo</div>
    </div>

    <script>
        // ========== DỮ LIỆU TRÒ CHƠI ==========
        let gameState = {
            currentScreen: "main-menu",
            currentLocation: null,
            currentChannel: null
        };

        let playerData = {
            level: 1,
            exp: 0,
            coins: 1000,
            health: 100,
            maxHealth: 100,
            fishInventory: [],
            rodsInventory: [
                { id: 1, name: "Cần Tre", level: 1, status: "Trống" },
                { id: 2, name: "Cần Tre", level: 1, status: "Trống" },
                { id: 3, name: "Cần Tre", level: 1, status: "Trống" },
                { id: 4, name: "Cần Tre", level: 1, status: "Trống" },
                { id: 5, name: "Cần Tre", level: 1, status: "Trống" }
            ],
            maxRods: 5
        };

        // ========== HÀM HIỂN THỊ THÔNG BÁO ==========
        function displayMessage(text, duration = 3) {
            const messageElement = document.getElementById("message");
            const messageText = document.getElementById("message-text");
            
            messageText.textContent = text;
            messageElement.classList.add("active");
            
            setTimeout(() => {
                messageElement.classList.remove("active");
            }, duration * 1000);
        }

        // ========== HÀM CHUYỂN MÀN HÌNH ==========
        function showScreen(screenId) {
            // Ẩn tất cả màn hình
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Hiển thị màn hình được chọn
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                gameState.currentScreen = screenId;
            }
            
            // Cập nhật UI
            updateUI();
        }

        // ========== HÀM CẬP NHẬT GIAO DIỆN ==========
        function updateUI() {
            // Cập nhật thông tin người chơi
            document.getElementById("player-level").textContent = playerData.level;
            document.getElementById("player-coins").textContent = playerData.coins;
            document.getElementById("player-hp").textContent = playerData.health;
            
            document.getElementById("char-level").textContent = playerData.level;
            document.getElementById("char-coins").textContent = playerData.coins;
            document.getElementById("char-hp").textContent = playerData.health;
            
            // Cập nhật thanh HP
            const hpPercent = (playerData.health / playerData.maxHealth) * 100;
            document.getElementById("hp-fill").style.width = `${hpPercent}%`;
            
            // Cập nhật thông tin cá
            const fishCount = playerData.fishInventory.length;
            const fishWeight = playerData.fishInventory.reduce((sum, fish) => sum + (fish.weight || 1), 0);
            document.getElementById("fish-caught").textContent = fishCount;
            document.getElementById("fish-weight").textContent = fishWeight.toFixed(2);
            document.getElementById("fishing-fish-count").textContent = fishCount;
            
            // Cập nhật thông tin cần câu
            document.getElementById("rods-count").textContent = playerData.rodsInventory.length;
            document.getElementById("max-rods").textContent = playerData.maxRods;
            document.getElementById("free-rods").textContent = playerData.rodsInventory.filter(r => r.status === "Trống").length;
            document.getElementById("fishing-max-rods").textContent = playerData.maxRods;
            
            // Cập nhật cửa hàng
            document.getElementById("shop-coins").textContent = playerData.coins;
            document.getElementById("inventory-coins").textContent = playerData.coins;
            document.getElementById("sell-coins").textContent = playerData.coins;
            
            // Cập nhật danh sách cần câu
            updateRodsList();
        }

        // ========== HÀM CẬP NHẬT DANH SÁCH CẦN CÂU ==========
        function updateRodsList() {
            const rodsContainer = document.getElementById("rods-container");
            if (rodsContainer) {
                rodsContainer.innerHTML = '';
                
                playerData.rodsInventory.forEach(rod => {
                    const rodElement = document.createElement("div");
                    rodElement.className = "inventory-item";
                    rodElement.style.display = "flex";
                    rodElement.style.justifyContent = "space-between";
                    rodElement.style.alignItems = "center";
                    rodElement.style.padding = "10px";
                    rodElement.style.borderBottom = "1px solid #444";
                    
                    rodElement.innerHTML = `
                        <div>
                            <strong>${rod.name}</strong> (Lv${rod.level})
                        </div>
                        <div>
                            ${rod.status}
                        </div>
                    `;
                    
                    rodsContainer.appendChild(rodElement);
                });
            }
        }

        // ========== HÀM XỬ LÝ SỰ KIỆN THĂM TRỘM ==========
        function handleSteal() {
            if (playerData.health >= 20) {
                playerData.health -= 20;
                
                // 50% cơ hội bắt được cá
                if (Math.random() > 0.5) {
                    const weight = (Math.random() * 2 + 0.5).toFixed(2);
                    playerData.fishInventory.push({
                        name: "Cá Lóc",
                        weight: parseFloat(weight),
                        exp: Math.floor(weight * 30)
                    });
                    displayMessage(`Trộm thành công! Bắt được cá Lóc ${weight}kg!`, 3);
                } else {
                    displayMessage("Trộm thất bại! Không có cá.", 3);
                }
                
                showScreen("main-menu");
            } else {
                displayMessage("Không đủ HP để thăm trộm!", 3);
            }
        }

        // ========== HÀM XỬ LÝ CẮM CÂU ==========
        function handleFishing() {
            const freeRod = playerData.rodsInventory.find(rod => rod.status === "Trống");
            
            if (freeRod) {
                freeRod.status = "Đang cắm";
                
                // Mô phỏng thời gian câu cá
                setTimeout(() => {
                    // 70% cơ hội bắt được cá
                    if (Math.random() > 0.3) {
                        const weight = (Math.random() * 3 + 0.1).toFixed(2);
                        playerData.fishInventory.push({
                            name: "Cá Lóc",
                            weight: parseFloat(weight),
                            exp: Math.floor(weight * 50)
                        });
                        displayMessage(`Câu thành công! Bắt được cá Lóc ${weight}kg!`, 3);
                    } else {
                        displayMessage("Câu cá thất bại! Không dính cá.", 3);
                    }
                    
                    freeRod.status = "Trống";
                    updateUI();
                }, 2000);
                
                displayMessage("Đã thả cần... đang chờ cá cắn câu!", 2);
            } else {
                displayMessage("Không có cần câu trống!", 3);
            }
        }

        // ========== HÀM MUA CẦN CÂU ==========
        function buyRod() {
            if (playerData.coins >= 10000) {
                if (playerData.rodsInventory.length < playerData.maxRods) {
                    playerData.coins -= 10000;
                    playerData.rodsInventory.push({
                        id: playerData.rodsInventory.length + 1,
                        name: "Cần Sắt",
                        level: 1,
                        status: "Trống"
                    });
                    displayMessage("Mua Cần Sắt thành công!", 3);
                } else {
                    displayMessage("Đã đạt giới hạn số lượng cần câu!", 3);
                }
            } else {
                displayMessage("Không đủ Xu! Cần 10,000 Xu.", 3);
            }
            updateUI();
        }

        // ========== HÀM NÂNG CẤP GIỚI HẠN CẦN CÂU ==========
        function upgradeRodLimit() {
            if (playerData.coins >= 50000 && playerData.maxRods < 10) {
                playerData.coins -= 50000;
                playerData.maxRods += 1;
                displayMessage(`Nâng cấp thành công! Giới hạn cần câu: ${playerData.maxRods}`, 3);
            } else if (playerData.maxRods >= 10) {
                displayMessage("Đã đạt giới hạn tối đa!", 3);
            } else {
                displayMessage("Không đủ Xu! Cần 50,000 Xu.", 3);
            }
            updateUI();
        }

        // ========== THIẾT LẬP SỰ KIỆN ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Màn hình chính
            document.getElementById('char-info-btn').addEventListener('click', () => showScreen('character-screen'));
            document.getElementById('inventory-btn').addEventListener('click', () => showScreen('inventory-screen'));
            document.getElementById('fishing-btn').addEventListener('click', () => showScreen('select-location'));
            document.getElementById('steal-btn').addEventListener('click', () => showScreen('steal-menu'));

            // Màn hình thông tin nhân vật
            document.getElementById('char-back-btn').addEventListener('click', () => showScreen('main-menu'));

            // Màn hình túi đồ
            document.getElementById('shop-btn').addEventListener('click', () => showScreen('shop-screen'));
            document.getElementById('sell-fish-btn').addEventListener('click', () => showScreen('sell-fish-screen'));
            document.getElementById('inventory-back-btn').addEventListener('click', () => showScreen('main-menu'));

            // Màn hình cửa hàng
            document.getElementById('buy-rod-btn').addEventListener('click', buyRod);
            document.getElementById('upgrade-limit-btn').addEventListener('click', upgradeRodLimit);
            document.getElementById('shop-back-btn').addEventListener('click', () => showScreen('inventory-screen'));

            // Màn hình bán cá
            document.getElementById('sell-back-btn').addEventListener('click', () => showScreen('inventory-screen'));

            // Màn hình chọn khu vực
            document.getElementById('location-back-btn').addEventListener('click', () => showScreen('main-menu'));
            document.querySelectorAll('#select-location .location-slot').forEach(button => {
                button.addEventListener('click', function() {
                    const location = this.getAttribute('data-location');
                    if (this.classList.contains('active')) {
                        gameState.currentLocation = location;
                        showScreen('select-channel');
                        document.getElementById('channel-location').textContent = `KHU VỰC: ${location}`;
                    }
                });
            });

            // Màn hình chọn kênh
            document.getElementById('channel-back-btn').addEventListener('click', () => showScreen('select-location'));
            document.querySelectorAll('#select-channel .location-slot').forEach(button => {
                button.addEventListener('click', function() {
                    const channel = this.getAttribute('data-channel');
                    gameState.currentChannel = channel;
                    showScreen('fishing-screen');
                    document.getElementById('fishing-location').textContent = `${gameState.currentLocation} - ${channel}`;
                });
            });

            // Màn hình câu cá
            document.getElementById('fishing-back-btn').addEventListener('click', () => showScreen('select-channel'));
            document.querySelectorAll('#fishing-screen .button[data-slot]').forEach(button => {
                button.addEventListener('click', function() {
                    handleFishing();
                });
            });

            // Màn hình thăm trộm
            document.getElementById('go-steal-btn').addEventListener('click', handleSteal);
            document.getElementById('steal-back-btn').addEventListener('click', () => showScreen('main-menu'));
            document.getElementById('steal-slots-back-btn').addEventListener('click', () => showScreen('main-menu'));
            document.querySelectorAll('#steal-slots .steal-slot').forEach(button => {
                button.addEventListener('click', function() {
                    handleSteal();
                });
            });

            // Khởi tạo game
            updateUI();
            displayMessage("Chào mừng đến với Cắm Câu Cá Lóc!", 3);
        });
    </script>
</body>
</html>